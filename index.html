<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css">
  <title>VozDaRua - Plataforma de Reclama√ß√µes</title>
</head>
<body>
  <header class="header" role="banner" aria-label="Menu superior">
    <div class="header-content">
      <img class="logo-img" src="VozDaRuaInt.png">
      <h1><a href="#" class="logo-link" onclick="mostrarConteudoInicial(event)">VozDaRua</a></h1>
      <nav>
        <ul>
          <li><button class="menu-btn" aria-label="Fazer Reclama√ß√£o" onclick="mostrarFormulario()">Fazer Reclama√ß√£o</button></li>
          <li><button class="menu-btn" aria-label="Listar suas Reclama√ß√µes" onclick="carregarReclamacoes()">Reclama√ß√µes Registradas</button></li>
          <li><button class="menu-btn" aria-label="Contatar Suporte" onclick="mostrarSuporte()">Contatar Suporte</button></li>
          <li><button class="menu-btn" aria-label="Sobre N√≥s" onclick="mostrarSobre()">Sobre N√≥s</button></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="main-content" role="main">
    <section class="intro" id="conteudo-inicial">
  <div class="intro-grid">
    <div class="intro-text">
      <h2>Bem-vindo ao VozDaRua</h2>
      <p>Compartilhe sua experi√™ncia e nos ajude a melhorar os servi√ßos p√∫blicos da nossa cidade. Fa√ßa uma reclama√ß√£o e acompanhe seu andamento.</p>

      <div class="como-funciona">
        <h2>Como Funciona?</h2>
        <p>O processo √© simples e r√°pido! Basta registrar a sua reclama√ß√£o, que ela ser√° encaminhada para os √≥rg√£os respons√°veis, onde voc√™ poder√° acompanhar o andamento e buscar a solu√ß√£o para o seu problema.</p>
      </div>

      <div class="seguranca">
        <h2>Seguran√ßa e Privacidade</h2>
        <p>Suas informa√ß√µes pessoais e a descri√ß√£o de sua reclama√ß√£o s√£o totalmente protegidas. Trabalhamos com criptografia e seguimos as melhores pr√°ticas de seguran√ßa para garantir que sua participa√ß√£o seja totalmente segura e confidencial.</p>
      </div>

      <div class="beneficios">
        <h2>Por que Usar o VozDaRua?</h2>
        <ul>
          <li><strong>Transpar√™ncia:</strong> Acompanhe o andamento da sua reclama√ß√£o em tempo real.</li>
          <li><strong>Impacto:</strong> Sua reclama√ß√£o √© direcionada diretamente aos √≥rg√£os p√∫blicos respons√°veis e fontes notici√°rias parceiras.</li>
          <li><strong>Contribui√ß√£o para a Comunidade:</strong> Ajude a melhorar os servi√ßos p√∫blicos e a qualidade de vida no seu bairro.</li>
          <li><strong>F√°cil e R√°pido:</strong> Processo simples e intuitivo para voc√™ registrar sua reclama√ß√£o em minutos.</li>
        </ul>
      </div>
    </div>
    <div class="intro-map">
      <iframe 
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3675.303679730087!2d-47.060829!3d-22.909938!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94c8cf3e7c1d31bb%3A0x97d8f1c8c7a4c64f!2sCampinas%20-%20SP!5e0!3m2!1spt-BR!2sbr!4v1692564838000!5m2!1spt-BR!2sbr" 
        allowfullscreen="" 
        loading="lazy">
      </iframe>

      <div class="map-info">
        <h3>üìç Informa√ß√µes de Campinas</h3>
        <ul>
          <li>Munic√≠pio: Campinas - SP</li>
          <li>Popula√ß√£o: +1,2 milh√£o de habitantes</li>
          <li>Principais Reclama√ß√µes: buracos, esgoto, ilumina√ß√£o p√∫blica</li>
          <li>Ajude a transformar sua cidade reportando problemas!</li>
        </ul>
      </div>
    </div>
  </div>
</section>

    <section class="form-reclamacao" id="form-reclamacao" style="display:none;">
      <div class="caixa-atencao">
      <h3>Aten√ß√£o!</h3>
      <p><strong>Fa√ßa uma reclama√ß√£o apropriada!</strong></p>
      <p>Nosso site √© dedicado a receber reclama√ß√µes e den√∫ncias sobre problemas que afetam de forma significativa a qualidade de vida na cidade de Campinas, especialmente nas √°reas de Infraestrutura, Sa√∫de, Ensino e servi√ßos p√∫blicos essenciais.</p>
      <p>Pedimos que evitem enviar reclama√ß√µes sobre assuntos de menor impacto coletivo, como picha√ß√µes, barulho de vizinhos, desentendimentos pessoais ou problemas pontuais sem relev√¢ncia p√∫blica. Esses casos devem ser tratados por canais apropriados, como a pol√≠cia ou a administra√ß√£o do condom√≠nio, por exemplo.</p>
      </div>

      <h2>Nova Reclama√ß√£o</h2>
      <form id="formReclamacao" enctype="multipart/form-data">
        <label for="descricao">Descri√ß√£o</label>
        <textarea id="descricao" name="descricao" rows="4" required></textarea>

        <!-- COLOCAR IMAGENS NAS DESCRI√á√ïES -->
        <label for="imagem">Imagem do Problema (opcional)</label>
        <input type="file" id="imagem" name="imagem" accept="image/*" />

        <label for="categoria">Categoria</label>
        <select id="categoria" name="categoria" required>
          <option value="">Selecione</option>
          <option value="saude">Sa√∫de</option>
          <option value="infraestrutura">Infraestrutura</option>
          <option value="ensino">Ensino</option>
          <option value="outro">Outro</option>
        </select>

        <label for="nome">Nome</label>
        <input type="text" id="nome" name="nome" required />

        <label for="cpf">CPF</label>
        <input type="text" id="cpf" name="cpf" required pattern="\d{11}" placeholder="Apenas n√∫meros" />

        <label for="endereco">Endere√ßo</label>
        <input type="text" id="endereco" name="endereco" required />

        <div id="mensagem-envio" style="margin-top: 10px;"></div>

        <button type="submit">Enviar</button>
      </form>
    </section>

    <section id="contato-suporte" style="display:none;">
      <h2>Contatar Suporte</h2>
      <p>Entre em contato conosco pelos canais abaixo:</p>
      <ul>
        <li><strong>üìû Telefone:</strong> (19) 91234-5678</li>
        <li>
          <strong>üì± WhatsApp:</strong>
          <a href="https://wa.me/5519912345678" target="_blank">(19) 91234-5678</a>
        </li>
        <li>
          <strong>üì∏ Instagram:</strong>
          <a href="https://instagram.com/vozdarua.ofc" target="_blank">@vozdarua.ofc</a>
        <li>
          <strong>üìß E-mail:</strong>
          <a>vozdarua.ofc@gmail.com</a>
      </ul>
    </section>

    <section class="intro" id="sobre" style="display:none;">
      <h2>VozDaRua - A Voz da Comunidade de Campinas</h2>
      <p>
        O VozDaRua √© uma plataforma criada para que os moradores de Campinas-SP possam registrar e acompanhar problemas em
        seus bairros, como falta de infraestrutura, sa√∫de prec√°ria, ou quest√µes educacionais. Nossa miss√£o √© dar visibilidade
        a essas reclama√ß√µes, facilitando a comunica√ß√£o entre a popula√ß√£o e os √≥rg√£os p√∫blicos respons√°veis.
      </p>
      <p>
        Sua participa√ß√£o √© essencial para melhorar a cidade. Fa√ßa a diferen√ßa e ajude a transformar os problemas do seu bairro em
        solu√ß√µes concretas!
      </p>
    </section>

    <section id="lista-reclamacoes" style="display:none;">
      <h2>Reclama√ß√µes Registradas</h2>
      <div id="tabela-reclamacoes">
      </div>
    </section>
  </main>

  <script>
    function toggleSections(sectionId) {
      const sections = [
        "conteudo-inicial",
        "form-reclamacao",
        "contato-suporte",
        "sobre",
        "lista-reclamacoes",
      ];
      sections.forEach((id) => {
        document.getElementById(id).style.display = id === sectionId ? "flex" : "none";
      });
    }

    function mostrarConteudoInicial(event) {
      event.preventDefault();
      toggleSections('conteudo-inicial');
    }

    function mostrarFormulario() {
      toggleSections("form-reclamacao");
    }

    function carregarReclamacoes() {
      toggleSections("lista-reclamacoes");
      fetch("listar_reclamacoes_ajax.php")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("tabela-reclamacoes").innerHTML = data;
        })
        .catch((error) => {
          console.error("Erro ao carregar reclama√ß√µes:", error);
          document.getElementById("tabela-reclamacoes").innerHTML =
            "<p>Erro ao carregar dados.</p>";
        });
    }

    function mostrarSuporte() {
      toggleSections("contato-suporte");
    }

    function mostrarSobre() {
      toggleSections("sobre");
    }

    // Fun√ß√£o de valida√ß√£o matem√°tica do CPF
    function validarCPF(cpf) {
      cpf = cpf.replace(/[^\d]+/g,''); // remove caracteres n√£o num√©ricos
      if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;

      let soma = 0, resto;

      // primeiro d√≠gito verificador
      for (let i = 1; i <= 9; i++) soma += parseInt(cpf[i-1]) * (11 - i);
      resto = (soma * 10) % 11;
      if ((resto === 10) || (resto === 11)) resto = 0;
      if (resto !== parseInt(cpf[9])) return false;

      soma = 0;
      // segundo d√≠gito verificador
      for (let i = 1; i <= 10; i++) soma += parseInt(cpf[i-1]) * (12 - i);
      resto = (soma * 10) % 11;
      if ((resto === 10) || (resto === 11)) resto = 0;
      if (resto !== parseInt(cpf[10])) return false;

      return true;
    }

    document.getElementById("formReclamacao").addEventListener("submit", function (event) {
    event.preventDefault(); // Impede o recarregamento da p√°gina

    const cpfInput = document.getElementById("cpf").value;
    if (!validarCPF(cpfInput)) {
      alert("CPF inv√°lido! Por favor, insira um CPF v√°lido.");
      return;
    }

    const form = this;
    const formData = new FormData(form);

    fetch("salvar_reclamacao.php", {
      method: "POST",
      body: formData,
    })
      .then((response) => response.text())
      .then((data) => {
        document.getElementById("mensagem-envio").innerHTML = data;
        form.reset(); // Limpa o formul√°rio
      })
      .catch((error) => {
        console.error("Erro:", error);
        document.getElementById("mensagem-envio").innerHTML = "<p>Erro ao enviar a reclama√ß√£o. Tente novamente.</p>";
      });
  });
  </script>
</body>
</html>

